<!DOCTYPE html><html lang="en"><head><script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-126240406-1"></script><script>window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'UA-126240406-1');</script><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" href="/favicon.ico"><title>[웹] React + TypeScript 상황에서 SFC의 defaultProps 에러메세지 처리 :: Myeongjae Kim</title><link href="/css/chunk-56479946.59ffc13f.css" rel="prefetch"><link href="/css/chunk-5c1f316c.502adc74.css" rel="prefetch"><link href="/js/chunk-56479946.1d7f29b9.js" rel="prefetch"><link href="/js/chunk-5c1f316c.15c54711.js" rel="prefetch"><link href="/css/app.fe15b8a9.css" rel="preload" as="style"><link href="/js/app.edc26767.js" rel="preload" as="script"><link href="/js/chunk-vendors.855aa201.js" rel="preload" as="script"><link href="/css/app.fe15b8a9.css" rel="stylesheet"><link rel="stylesheet" type="text/css" href="/css/chunk-5c1f316c.502adc74.css"><script charset="utf-8" src="/js/chunk-5c1f316c.15c54711.js"></script><meta charset="utf-8" data-vue-meta="true"><meta property="og:image" content="https://avatars2.githubusercontent.com/u/15189621" data-vmid="og:image" data-vue-meta="true"><meta property="og:title" content="default-props-react-ts :: Myeongjae Kim" data-vmid="og:title" data-vue-meta="true"><meta property="og:description" content="Thank you for reading my article 🙈" data-vmid="og:description" data-vue-meta="true"><script type="text/javascript" async="">var disqus_shortname  = "myeongjae";
var disqus_title      = "default-props-react-ts";
var disqus_identifier = "/2019/03/04/default-props-react-ts";
var disqus_url        = "https://blog.myeongjae.kim/2019/03/04/default-props-react-ts";
</script><script type="text/javascript" async="" src="//myeongjae.disqus.com/embed.js"></script><link rel="preload" as="style" href="https://c.disquscdn.com/next/embed/styles/lounge.9974049bf7b0591e5d4f055cb67f3ee3.css"><link rel="preload" as="script" href="https://c.disquscdn.com/next/embed/common.bundle.880980e048a2432334f13013030456ac.js"><link rel="preload" as="script" href="https://c.disquscdn.com/next/embed/lounge.bundle.4180262f1aa52e0f0340aac9fc52a8d8.js"><link rel="preload" as="script" href="https://disqus.com/next/config.js"></head><body><div id="app"><div id="site-title"><a href="/" class="mat-button no-shadow router-link-active">Myeongjae Kim</a></div><nav><a href="/" class="mat-button no-shadow router-link-active">About</a><a href="/blog/" class="mat-button no-shadow router-link-active router-link-exact-active">Blog</a><a href="/daily/" class="mat-button no-shadow">Daily</a><a href="/musings/" class="mat-button no-shadow">Musings</a><a href="/places/" class="mat-button no-shadow">Places</a></nav><div data-v-368dc640="" id="blog"><div data-v-368dc640="" id="blog-contents"><article data-v-368dc640=""><div data-v-368dc640="" class="inner-title-container"><h1 data-v-368dc640=""><a data-v-368dc640="" href="https://blog.myeongjae.kim/2019/03/04/default-props-react-ts" id="inner-title">[웹] React + TypeScript 상황에서 SFC의 defaultProps 에러메세지 처리</a></h1><p data-v-368dc640="" class="meta">2019 / 03 / 04</p></div><div data-v-368dc640="" id="padding-between-title-and-article"></div><div data-v-368dc640="" id="article-content"><h1 id="웹-react-typescript-상황에서-sfc의-defaultprops-에러메세지-처리" style="display: none;">[웹] React + TypeScript 상황에서 SFC의 defaultProps 에러메세지 처리</h1>
<p>요약: SFC 타입 선언에 <code class="hljs vim">&amp; { defaultProp<span class="hljs-variable">s:</span> Partial<span class="hljs-symbol">&lt;ICurrentComponentProps&gt;</span> }</code>를 추가합니다. <code class="hljs">ICurrentComponentProps</code>는 상황에 맞게 바꿉니다.</p>
<p><a href="http://www.kyobobook.co.kr/product/detailViewKor.laf?ejkGb=KOR&amp;mallGb=KOR&amp;barcode=9791160505238&amp;orderClick=LEA&amp;Kc=">리액트를 다루는 기술</a>의 챕터 13을 TypeScript를 사용해 구현하면서 만난 문제의 <a href="https://github.com/Microsoft/TypeScript/issues/27425#issuecomment-440936580">해결책</a>입니다. 전체 코드는 여기서 볼 수 있습니다: <a href="https://github.com/myeongjae-kim/learn-react-redux-counter/tree/sfc-default-props" class="uri">https://github.com/myeongjae-kim/learn-react-redux-counter/tree/sfc-default-props</a></p>
<p>TypeScript 없이 작성한 코드는 다음과 같습니다(<a href="http://www.kyobobook.co.kr/product/detailViewKor.laf?ejkGb=KOR&amp;mallGb=KOR&amp;barcode=9791160505238&amp;orderClick=LEA&amp;Kc=">책</a> 257페이지).</p>
<pre class="javascript"><code class="hljs"><span class="hljs-comment">// Filepath: src/components/Counter.js</span>
<span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> PropTypes <span class="hljs-keyword">from</span> <span class="hljs-string">'prop-types'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'./Counter.css'</span>;

<span class="hljs-keyword">const</span> Counter = <span class="hljs-function">(<span class="hljs-params">{number, color, onIncrement, onDecrement, onSetColor}</span>) =&gt;</span> {
  <span class="hljs-keyword">return</span> (
    &lt;div
      className="Counter"
      onClick={onIncrement}
      onContextMenu={(e) =&gt; {
        e.preventDefault();
        onDecrement();
      }}
      onDoubleClick={onSetColor}
      style={{
        backgroundColor: color
      }}&gt;
      {number}
    &lt;/div&gt;
  )
};

Counter.propTypes = {
  <span class="hljs-attr">number</span>: PropTypes.number,
  <span class="hljs-attr">color</span>: PropTypes.string,
  <span class="hljs-attr">onIncrement</span>: PropTypes.func,
  <span class="hljs-attr">onDecrement</span>: PropTypes.func,
  <span class="hljs-attr">onSetColor</span>: PropTypes.func
};

Counter.defaultProps = {
  <span class="hljs-attr">number</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">color</span>: <span class="hljs-string">'black'</span>,
  <span class="hljs-attr">onIncrement</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">'onIncrement not defined'</span>),
  <span class="hljs-attr">onDecrement</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">'onDecrement not defined'</span>),
  <span class="hljs-attr">onSetColor</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">'onSetColor not defined'</span>)
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Counter;</code></pre>
<p>위의 SFC(Stateless Functional Component)에는 5개의 <code class="hljs">props</code>가 있고 모두 기본값이 있습니다. 아래처럼 <code class="hljs">props</code>를 지정하지 않아도 작동합니다.</p>
<pre class="javascript"><code class="hljs"><span class="hljs-comment">// Filepath: src/containers/App.js</span>
<span class="hljs-keyword">import</span> React, { Component } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> Counter <span class="hljs-keyword">from</span> <span class="hljs-string">'../components/Counter'</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{
  render() {
    <span class="hljs-keyword">return</span> (
      &lt;div&gt;
        &lt;Counter/&gt; // No Props
      &lt;/div&gt;
    )
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> App;</code></pre>
<p>TypeScript(<code class="hljs vim"><span class="hljs-keyword">version</span>: <span class="hljs-number">3.3</span>.<span class="hljs-number">3333</span></code>)로 다시 쓰면 다음과 같습니다.</p>
<pre class="javascript"><code class="hljs"><span class="hljs-comment">// Filepath: src/components/Counter.tsx</span>
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">'./Counter.css'</span>

<span class="hljs-keyword">export</span> interface ICounterProps {
  <span class="hljs-attr">number</span>: number
  color: string
  onIncrement: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">void</span>
  onDecrement: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">void</span>
  onSetColor: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-keyword">void</span>
};

<span class="hljs-keyword">const</span> Counter: React.SFC&lt;ICounterProps&gt; =
  <span class="hljs-function">(<span class="hljs-params">{ number, color, onIncrement, onDecrement, onSetColor }</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> (
      &lt;div
        className="Counter"
        onClick={onIncrement}
        onContextMenu={(e) =&gt; {
          e.preventDefault();
          onDecrement();
        }}
        onDoubleClick={onSetColor}
        style={{ backgroundColor: color }}
      &gt;
        {number}
      &lt;/div&gt;);
  };

Counter.defaultProps = {
  <span class="hljs-attr">number</span>: <span class="hljs-number">0</span>,
  <span class="hljs-attr">color</span>: <span class="hljs-string">'black'</span>,
  <span class="hljs-attr">onIncrement</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">'onIncrement not defined'</span>),
  <span class="hljs-attr">onDecrement</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">'onDecrement not defined'</span>),
  <span class="hljs-attr">onSetColor</span>: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">'onSetColor not defined'</span>)
};

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> Counter;</code></pre>
<pre class="javascript"><code class="hljs"><span class="hljs-comment">// Filepath: src/containers/App.tsx</span>
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span> Counter <span class="hljs-keyword">from</span> <span class="hljs-string">'../components/Counter'</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">App</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">React</span>.<span class="hljs-title">Component</span>&lt;</span>{}, {}&gt; {
  render() {
    <span class="hljs-keyword">return</span> (&lt;div&gt;
      &lt;Counter /&gt;
    &lt;/div&gt;);
  }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> App;</code></pre>
<p><code class="hljs">yarn start</code>를 하면 다음과 같은 메세지를 볼 수 있습니다.</p>
<pre><code class="hljs bash">.../redux-counter/src/containers/App.tsx
Type error: Type <span class="hljs-string">'{}'</span> is missing the following properties from <span class="hljs-built_in">type</span> <span class="hljs-string">'ICounterProps'</span>: number, color, onIncrement, onDecrement, onSetColor  TS2739

     5 |   <span class="hljs-function"><span class="hljs-title">render</span></span>() {
     6 |     <span class="hljs-built_in">return</span> (&lt;div&gt;
  &gt;  7 |       &lt;Counter /&gt; // No Props
       |        ^
     8 |     &lt;/div&gt;);
     9 |   }
    10 | }</code></pre>
<p>React + TypeScript 상황에서 <code class="hljs">defaultProps</code>의 곤란함은 <a href="https://medium.com/@FourwingsY/react%EC%99%80-javascript%EC%9D%98-%EB%AF%B8%EB%AC%98%ED%95%9C-%EB%B6%88%EC%9D%BC%EC%B9%98-b8f0e2bfe05d">React와 Typescript의 미묘한 불일치</a>에 잘 나와있습니다. 다행히 TypeScript 3.0이 되면서 간단하게 해결이 가능해졌습니다. <code class="hljs">App.tsx</code>의 SFC 타입 선언에서 <code class="hljs vim">&amp; { defaultProp<span class="hljs-variable">s:</span> Partial<span class="hljs-symbol">&lt;ICounterProps&gt;</span> }</code>를 추가합니다.</p>
<pre class="javascript"><code class="hljs"><span class="hljs-comment">// Filepath: src/components/Counter.tsx</span>
<span class="hljs-keyword">const</span> Counter: React.SFC&lt;ICounterProps&gt; &amp; { <span class="hljs-attr">defaultProps</span>: Partial&lt;ICounterProps&gt; } =
  <span class="hljs-function">(<span class="hljs-params">{ number, color, onIncrement, onDecrement, onSetColor }</span>) =&gt;</span> {
    <span class="hljs-keyword">return</span> (
      &lt;div
        className="Counter"
        onClick={onIncrement}
        onContextMenu={(e) =&gt; {
          e.preventDefault();
          onDecrement();
        }}
        onDoubleClick={onSetColor}
        style={{ backgroundColor: color }}
      &gt;
        {number}
      &lt;/div&gt;);
  };</code></pre>
<p><code class="hljs">Partial</code>은 Type의 모든 property를 optional로 만들어버립니다.</p>
<pre class="typescript"><code class="hljs"><span class="hljs-comment">/**
 * Make all properties in T optional
 */</span>
<span class="hljs-keyword">type</span> Partial&lt;T&gt; = {
    [P <span class="hljs-keyword">in</span> keyof T]?: T[P];
};</code></pre>
<hr>
<p>P.S.</p>
<ol type="1">
<li>추상화의 힘에 항상 감탄합니다. <a href="http://www.kyobobook.co.kr/product/detailViewKor.laf?ejkGb=KOR&amp;mallGb=KOR&amp;barcode=9791160504880&amp;orderClick=LAG&amp;Kc=">알고리즘 산책: 수학에서 제네릭 프로그래밍까지</a>를 사놓고 못 읽고 있는데, 얼른 읽어봐야겠습니다.</li>
<li>블로그의 코드 하이라이팅에 <a href="https://highlightjs.org/">highlight.js</a>를 쓰고있는데 <code class="hljs">jsx</code>와 <code class="hljs">tsx</code>를 지원하지 않습니다. <a href="https://prismjs.com/">Prism.js</a>로 갈아타보도록 하겠습니다.</li>
</ol>
</div></article><hr data-v-368dc640=""><div data-v-368dc640="" id="adjacent-articles"><div data-v-368dc640="" id="next-article"><h4 data-v-368dc640="">Next Article</h4><p data-v-368dc640=""><a data-v-368dc640="" href="/blog/2019/03/06/counter-redux-typescript/" class="">[웹] 책 ⟨리액트를 다루는 기술⟩의 13장 Counter실습 + TypeScript</a></p></div><div data-v-368dc640="" id="prev-article"><h4 data-v-368dc640="">Previous Article</h4><p data-v-368dc640=""><a data-v-368dc640="" href="/blog/2019/03/02/react-ts-sass-cssmodules-classnames/" class="">[웹] 책 ⟨리액트를 다루는 기술⟩의 todo-list + TypeScript</a></p></div></div><hr data-v-368dc640="" style="margin-top: 28px;"><div data-v-368dc640="" id="share-buttons"><button data-v-368dc640="" data-clipboard-text="https://blog.myeongjae.kim/2019/03/04/default-props-react-ts" class="copy-btn">Copy Link</button>
      &nbsp;
      <a data-v-368dc640="" href="/blog/" class="router-link-active"><button data-v-368dc640="">Article List</button></a></div><div data-v-368dc640="" id="disqus_thread"><iframe id="dsq-app7064" name="dsq-app7064" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="https://disqus.com/embed/comments/?base=default&amp;f=myeongjae&amp;t_i=%2F2019%2F03%2F04%2Fdefault-props-react-ts&amp;t_u=https%3A%2F%2Fblog.myeongjae.kim%2F2019%2F03%2F04%2Fdefault-props-react-ts&amp;t_e=default-props-react-ts&amp;t_d=%5B%EC%9B%B9%5D%20React%20%2B%20TypeScript%20%EC%83%81%ED%99%A9%EC%97%90%EC%84%9C%20SFC%EC%9D%98%20defaultProps%20%EC%97%90%EB%9F%AC%EB%A9%94%EC%84%B8%EC%A7%80%20%EC%B2%98%EB%A6%AC&amp;t_t=default-props-react-ts&amp;s_o=default&amp;d_m=0#version=3cd87e0f949a3290918feaf8a303966c" style="width: 1px !important; min-width: 100% !important; border: none !important; overflow: hidden !important; height: 0px !important;"></iframe></div></div><a data-v-368dc640="" class="back-to-top">↑</a></div></div><script src="/js/chunk-vendors.855aa201.js"></script><script src="/js/app.edc26767.js"></script><iframe style="display: none;"></iframe></body></html>