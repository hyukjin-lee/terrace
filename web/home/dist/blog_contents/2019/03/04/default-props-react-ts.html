<h1 id="웹-react-typescript-상황에서-sfc의-defaultprops-에러메세지-처리">[웹] React + TypeScript 상황에서 SFC의 defaultProps 에러메세지 처리</h1>
<p>요약: SFC 타입 선언에 <code>&amp; { defaultProps: Partial&lt;ICurrentComponentProps&gt; }</code>를 추가합니다. <code>ICurrentComponentProps</code>는 상황에 맞게 바꿉니다.</p>
<p><a href="http://www.kyobobook.co.kr/product/detailViewKor.laf?ejkGb=KOR&amp;mallGb=KOR&amp;barcode=9791160505238&amp;orderClick=LEA&amp;Kc=">리액트를 다루는 기술</a>의 챕터 13을 TypeScript를 사용해 구현하면서 만난 문제의 <a href="https://github.com/Microsoft/TypeScript/issues/27425#issuecomment-440936580">해결책</a>입니다. 전체 코드는 여기서 볼 수 있습니다: <a href="https://github.com/myeongjae-kim/learn-react-redux-counter/tree/sfc-default-props" class="uri">https://github.com/myeongjae-kim/learn-react-redux-counter/tree/sfc-default-props</a></p>
<p>TypeScript 없이 작성한 코드는 다음과 같습니다(<a href="http://www.kyobobook.co.kr/product/detailViewKor.laf?ejkGb=KOR&amp;mallGb=KOR&amp;barcode=9791160505238&amp;orderClick=LEA&amp;Kc=">책</a> 257페이지).</p>
<pre class="javascript"><code>// Filepath: src/components/Counter.js
import React from &#39;react&#39;;
import PropTypes from &#39;prop-types&#39;;
import &#39;./Counter.css&#39;;

const Counter = ({number, color, onIncrement, onDecrement, onSetColor}) =&gt; {
  return (
    &lt;div
      className=&quot;Counter&quot;
      onClick={onIncrement}
      onContextMenu={(e) =&gt; {
        e.preventDefault();
        onDecrement();
      }}
      onDoubleClick={onSetColor}
      style={{
        backgroundColor: color
      }}&gt;
      {number}
    &lt;/div&gt;
  )
};

Counter.propTypes = {
  number: PropTypes.number,
  color: PropTypes.string,
  onIncrement: PropTypes.func,
  onDecrement: PropTypes.func,
  onSetColor: PropTypes.func
};

Counter.defaultProps = {
  number: 0,
  color: &#39;black&#39;,
  onIncrement: () =&gt; console.warn(&#39;onIncrement not defined&#39;),
  onDecrement: () =&gt; console.warn(&#39;onDecrement not defined&#39;),
  onSetColor: () =&gt; console.warn(&#39;onSetColor not defined&#39;)
};

export default Counter;</code></pre>
<p>위의 SFC(Stateless Functional Component)에는 5개의 <code>props</code>가 있고 모두 기본값이 있습니다. 아래처럼 <code>props</code>를 지정하지 않아도 작동합니다.</p>
<pre class="javascript"><code>// Filepath: src/containers/App.js
import React, { Component } from &#39;react&#39;;
import Counter from &#39;../components/Counter&#39;;

class App extends Component {
  render() {
    return (
      &lt;div&gt;
        &lt;Counter/&gt; // No Props
      &lt;/div&gt;
    )
  }
}

export default App;</code></pre>
<p>TypeScript(<code>version: 3.3.3333</code>)로 다시 쓰면 다음과 같습니다.</p>
<pre class="javascript"><code>// Filepath: src/components/Counter.tsx
import * as React from &#39;react&#39;;
import &#39;./Counter.css&#39;

export interface ICounterProps {
  number: number
  color: string
  onIncrement: () =&gt; void
  onDecrement: () =&gt; void
  onSetColor: () =&gt; void
};

const Counter: React.SFC&lt;ICounterProps&gt; =
  ({ number, color, onIncrement, onDecrement, onSetColor }) =&gt; {
    return (
      &lt;div
        className=&quot;Counter&quot;
        onClick={onIncrement}
        onContextMenu={(e) =&gt; {
          e.preventDefault();
          onDecrement();
        }}
        onDoubleClick={onSetColor}
        style={{ backgroundColor: color }}
      &gt;
        {number}
      &lt;/div&gt;);
  };

Counter.defaultProps = {
  number: 0,
  color: &#39;black&#39;,
  onIncrement: () =&gt; console.warn(&#39;onIncrement not defined&#39;),
  onDecrement: () =&gt; console.warn(&#39;onDecrement not defined&#39;),
  onSetColor: () =&gt; console.warn(&#39;onSetColor not defined&#39;)
};

export default Counter;</code></pre>
<pre class="javascript"><code>// Filepath: src/containers/App.tsx
import * as React from &#39;react&#39;;
import Counter from &#39;../components/Counter&#39;

class App extends React.Component&lt;{}, {}&gt; {
  render() {
    return (&lt;div&gt;
      &lt;Counter /&gt;
    &lt;/div&gt;);
  }
}

export default App;</code></pre>
<p><code>yarn start</code>를 하면 다음과 같은 메세지를 볼 수 있습니다.</p>
<pre><code>.../redux-counter/src/containers/App.tsx
Type error: Type &#39;{}&#39; is missing the following properties from type &#39;ICounterProps&#39;: number, color, onIncrement, onDecrement, onSetColor  TS2739

     5 |   render() {
     6 |     return (&lt;div&gt;
  &gt;  7 |       &lt;Counter /&gt; // No Props
       |        ^
     8 |     &lt;/div&gt;);
     9 |   }
    10 | }</code></pre>
<p>React + TypeScript 상황에서 <code>defaultProps</code>의 곤란함은 <a href="https://medium.com/@FourwingsY/react%EC%99%80-javascript%EC%9D%98-%EB%AF%B8%EB%AC%98%ED%95%9C-%EB%B6%88%EC%9D%BC%EC%B9%98-b8f0e2bfe05d">React와 Typescript의 미묘한 불일치</a>에 잘 나와있습니다. 다행히 TypeScript 3.0이 되면서 간단하게 해결이 가능해졌습니다. <code>App.tsx</code>의 SFC 타입 선언에서 <code>&amp; { defaultProps: Partial&lt;ICounterProps&gt; }</code>를 추가합니다.</p>
<pre class="javascript"><code>// Filepath: src/components/Counter.tsx
const Counter: React.SFC&lt;ICounterProps&gt; &amp; { defaultProps: Partial&lt;ICounterProps&gt; } =
  ({ number, color, onIncrement, onDecrement, onSetColor }) =&gt; {
    return (
      &lt;div
        className=&quot;Counter&quot;
        onClick={onIncrement}
        onContextMenu={(e) =&gt; {
          e.preventDefault();
          onDecrement();
        }}
        onDoubleClick={onSetColor}
        style={{ backgroundColor: color }}
      &gt;
        {number}
      &lt;/div&gt;);
  };</code></pre>
<p><code>Partial</code>은 Type의 모든 property를 optional로 만들어버립니다.</p>
<pre class="typescript"><code>/**
 * Make all properties in T optional
 */
type Partial&lt;T&gt; = {
    [P in keyof T]?: T[P];
};</code></pre>
<hr />
<p>P.S.</p>
<ol type="1">
<li>추상화의 힘에 항상 감탄합니다. <a href="http://www.kyobobook.co.kr/product/detailViewKor.laf?ejkGb=KOR&amp;mallGb=KOR&amp;barcode=9791160504880&amp;orderClick=LAG&amp;Kc=">알고리즘 산책: 수학에서 제네릭 프로그래밍까지</a>를 사놓고 못 읽고 있는데, 얼른 읽어봐야겠습니다.</li>
<li>블로그의 코드 하이라이팅에 <a href="https://highlightjs.org/">highlight.js</a>를 쓰고있는데 <code>jsx</code>와 <code>tsx</code>를 지원하지 않습니다. <a href="https://prismjs.com/">Prism.js</a>로 갈아타보도록 하겠습니다.</li>
</ol>
